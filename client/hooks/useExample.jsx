import React, { useEffect } from 'react';

import { create, write } from '../IndexedDB';
import { preProcess } from './useProcessor/processor';

const getModelSize = (model) => {
  return model.match(/(.*[^0-9]\b)([0-9]+gb).*/)[2];
}

const DATA = [
  { id:1, type:'iphone-11-pro-max', carrier:'at-t', price1:100, price2:83 },
  { id:2, type:'iphone-11-pro-max', carrier:'at-t', price1:179, price2:179 },
  { id:3, type:'iphone-11-pro-max', carrier:'at-t', price1:179, price2:179 },
  { id:4, type:'iphone-11-pro-max', carrier:'sprint', price1:174, price2:174 },
  { id:5, type:'iphone-11-pro-max', carrier:'sprint', price1:180, price2:180 },
  { id:6, type:'iphone-11-pro-max', carrier:'sprint', price1:180, price2:180 },
  { id:7, type:'iphone-11-pro-max', carrier:'t-mobile', price1:100, price2:83 },
  { id:8, type:'iphone-11-pro-max', carrier:'t-mobile', price1:180, price2:180 },
  { id:9, type:'iphone-11-pro-max', carrier:'t-mobile', price1:181, price2:181 },
  { id:10, type:'iphone-11-pro-max', carrier:'verizon', price1:176, price2:176 },
  { id:11, type:'iphone-11-pro-max', carrier:'verizon', price1:182, price2:182 },
  { id:12, type:'iphone-11-pro-max', carrier:'verizon', price1:182, price2:182 },
  { id:13, type:'iphone-11-pro-max', carrier:'unlocked', price1:183, price2:183 },
  { id:14, type:'iphone-11-pro-max', carrier:'unlocked', price1:185, price2:185 },
  { id:15, type:'iphone-11-pro-max', carrier:'unlocked', price1:192, price2:192 },
  { id:16, type:'iphone-11-pro-max', carrier:'other', price1:153, price2:83 },
  { id:17, type:'iphone-11-pro-max', carrier:'other', price1:180, price2:179 },
  { id:18, type:'iphone-11-pro-max', carrier:'other', price1:180, price2:179 },
  { id:19, type:'iphone-11-pro', carrier:'at-t', price1:87, price2:75 },
  { id:20, type:'iphone-11-pro', carrier:'at-t', price1:160, price2:160 },
  { id:21, type:'iphone-11-pro', carrier:'at-t', price1:160, price2:160 },
  { id:22, type:'iphone-11-pro', carrier:'sprint', price1:100, price2:76 },
  { id:23, type:'iphone-11-pro', carrier:'sprint', price1:163, price2:163 },
  { id:24, type:'iphone-11-pro', carrier:'sprint', price1:163, price2:163 },
  { id:25, type:'iphone-11-pro', carrier:'t-mobile', price1:86, price2:77 },
  { id:26, type:'iphone-11-pro', carrier:'t-mobile', price1:163, price2:163 },
  { id:27, type:'iphone-11-pro', carrier:'t-mobile', price1:163, price2:163 },
  { id:28, type:'iphone-11-pro', carrier:'verizon', price1:160, price2:160 },
  { id:29, type:'iphone-11-pro', carrier:'verizon', price1:166, price2:166 },
  { id:30, type:'iphone-11-pro', carrier:'verizon', price1:166, price2:166 },
  { id:31, type:'iphone-11-pro', carrier:'unlocked', price1:158, price2:158 },
  { id:32, type:'iphone-11-pro', carrier:'unlocked', price1:165, price2:165 },
  { id:33, type:'iphone-11-pro', carrier:'unlocked', price1:171, price2:171 },
  { id:34, type:'iphone-11-pro', carrier:'other', price1:137, price2:75 },
  { id:35, type:'iphone-11-pro', carrier:'other', price1:160, price2:160 },
  { id:36, type:'iphone-11-pro', carrier:'other', price1:164, price2:163 },
  { id:37, type:'iphone-11', carrier:'at-t', price1:98, price2:98 },
  { id:38, type:'iphone-11', carrier:'at-t', price1:100, price2:100 },
  { id:39, type:'iphone-11', carrier:'at-t', price1:101, price2:101 },
  { id:40, type:'iphone-11', carrier:'sprint', price1:95, price2:95 },
  { id:41, type:'iphone-11', carrier:'sprint', price1:101, price2:101 },
  { id:42, type:'iphone-11', carrier:'sprint', price1:101, price2:101 },
  { id:43, type:'iphone-11', carrier:'t-mobile', price1:96, price2:96 },
  { id:44, type:'iphone-11', carrier:'t-mobile', price1:101, price2:101 },
  { id:45, type:'iphone-11', carrier:'t-mobile', price1:101, price2:101 },
  { id:46, type:'iphone-11', carrier:'verizon', price1:101, price2:101 },
  { id:47, type:'iphone-11', carrier:'verizon', price1:108, price2:108 },
  { id:48, type:'iphone-11', carrier:'verizon', price1:109, price2:109 },
  { id:49, type:'iphone-11', carrier:'unlocked', price1:116, price2:116 },
  { id:50, type:'iphone-11', carrier:'unlocked', price1:116, price2:116 },
  { id:51, type:'iphone-11', carrier:'unlocked', price1:116, price2:116 },
  { id:52, type:'iphone-11', carrier:'other', price1:97, price2:97 },
  { id:53, type:'iphone-11', carrier:'other', price1:104, price2:101 },
  { id:54, type:'iphone-11', carrier:'other', price1:120, price2:105 },
  { id:55, type:'iphone-xs-max', carrier:'at-t', price1:95, price2:71 },
  { id:56, type:'iphone-xs-max', carrier:'at-t', price1:76, price2:72 },
  { id:57, type:'iphone-xs-max', carrier:'at-t', price1:79, price2:74 },
  { id:58, type:'iphone-xs-max', carrier:'sprint', price1:98, price2:70 },
  { id:59, type:'iphone-xs-max', carrier:'sprint', price1:85, price2:72 },
  { id:60, type:'iphone-xs-max', carrier:'sprint', price1:84, price2:72 },
  { id:61, type:'iphone-xs-max', carrier:'t-mobile', price1:95, price2:71 },
  { id:62, type:'iphone-xs-max', carrier:'t-mobile', price1:78, price2:71 },
  { id:63, type:'iphone-xs-max', carrier:'t-mobile', price1:76, price2:71 },
  { id:64, type:'iphone-xs-max', carrier:'verizon', price1:102, price2:73 },
  { id:65, type:'iphone-xs-max', carrier:'verizon', price1:81, price2:75 },
  { id:66, type:'iphone-xs-max', carrier:'verizon', price1:81, price2:74 },
  { id:67, type:'iphone-xs-max', carrier:'unlocked', price1:91, price2:85 },
  { id:68, type:'iphone-xs-max', carrier:'unlocked', price1:98, price2:91 },
  { id:69, type:'iphone-xs-max', carrier:'unlocked', price1:101, price2:89 },
  { id:70, type:'iphone-xs-max', carrier:'other', price1:110, price2:71 },
  { id:71, type:'iphone-xs-max', carrier:'other', price1:110, price2:71 },
  { id:72, type:'iphone-xs-max', carrier:'other', price1:110, price2:71 },
  { id:73, type:'iphone-xs', carrier:'at-t', price1:67, price2:56 },
  { id:74, type:'iphone-xs', carrier:'at-t', price1:58, price2:58 },
  { id:75, type:'iphone-xs', carrier:'at-t', price1:61, price2:61 },
  { id:76, type:'iphone-xs', carrier:'sprint', price1:69, price2:56 },
  { id:77, type:'iphone-xs', carrier:'sprint', price1:61, price2:58 },
  { id:78, type:'iphone-xs', carrier:'sprint', price1:57, price2:57 },
  { id:79, type:'iphone-xs', carrier:'t-mobile', price1:67, price2:56 },
  { id:80, type:'iphone-xs', carrier:'t-mobile', price1:57, price2:57 },
  { id:81, type:'iphone-xs', carrier:'t-mobile', price1:57, price2:57 },
  { id:82, type:'iphone-xs', carrier:'verizon', price1:74, price2:59 },
  { id:83, type:'iphone-xs', carrier:'verizon', price1:60, price2:59 },
  { id:84, type:'iphone-xs', carrier:'verizon', price1:59, price2:59 },
  { id:85, type:'iphone-xs', carrier:'unlocked', price1:76, price2:76 },
  { id:86, type:'iphone-xs', carrier:'unlocked', price1:80, price2:80 },
  { id:87, type:'iphone-xs', carrier:'unlocked', price1:81, price2:81 },
  { id:88, type:'iphone-xs', carrier:'other', price1:83, price2:55 },
  { id:89, type:'iphone-xs', carrier:'other', price1:83, price2:56 },
  { id:90, type:'iphone-xs', carrier:'other', price1:83, price2:57 },
  { id:91, type:'iphone-xr', carrier:'at-t', price1:54, price2:54 },
  { id:92, type:'iphone-xr', carrier:'at-t', price1:59, price2:59 },
  { id:93, type:'iphone-xr', carrier:'at-t', price1:60, price2:60 },
  { id:94, type:'iphone-xr', carrier:'sprint', price1:52, price2:52 },
  { id:95, type:'iphone-xr', carrier:'sprint', price1:59, price2:59 },
  { id:96, type:'iphone-xr', carrier:'sprint', price1:60, price2:60 },
  { id:97, type:'iphone-xr', carrier:'t-mobile', price1:52, price2:52 },
  { id:98, type:'iphone-xr', carrier:'t-mobile', price1:59, price2:59 },
  { id:99, type:'iphone-xr', carrier:'t-mobile', price1:59, price2:59 },
  { id:100, type:'iphone-xr', carrier:'verizon', price1:61, price2:55 },
  { id:101, type:'iphone-xr', carrier:'verizon', price1:61, price2:61 },
  { id:102, type:'iphone-xr', carrier:'verizon', price1:60, price2:60 },
  { id:103, type:'iphone-xr', carrier:'unlocked', price1:69, price2:69 },
  { id:104, type:'iphone-xr', carrier:'unlocked', price1:77, price2:77 },
  { id:105, type:'iphone-xr', carrier:'unlocked', price1:78, price2:78 },
  { id:106, type:'iphone-xr', carrier:'other', price1:65, price2:51 },
  { id:107, type:'iphone-xr', carrier:'other', price1:68, price2:57 },
  { id:108, type:'iphone-xr', carrier:'other', price1:68, price2:57 },
  { id:109, type:'iphone-x', carrier:'at-t', price1:68, price2:68 },
  { id:110, type:'iphone-x', carrier:'at-t', price1:71, price2:71 },
  { id:111, type:'iphone-x', carrier:'sprint', price1:67, price2:67 },
  { id:112, type:'iphone-x', carrier:'sprint', price1:70, price2:70 },
  { id:113, type:'iphone-x', carrier:'t-mobile', price1:67, price2:67 },
  { id:114, type:'iphone-x', carrier:'t-mobile', price1:70, price2:70 },
  { id:115, type:'iphone-x', carrier:'verizon', price1:67, price2:67 },
  { id:116, type:'iphone-x', carrier:'verizon', price1:74, price2:74 },
  { id:117, type:'iphone-x', carrier:'unlocked', price1:80, price2:80 },
  { id:118, type:'iphone-x', carrier:'unlocked', price1:88, price2:88 },
  { id:119, type:'iphone-x', carrier:'other', price1:66, price2:66 },
  { id:120, type:'iphone-x', carrier:'other', price1:70, price2:70 },
  { id:121, type:'iphone-8-plus', carrier:'at-t', price1:56, price2:56 },
  { id:122, type:'iphone-8-plus', carrier:'at-t', price1:57, price2:57 },
  { id:123, type:'iphone-8-plus', carrier:'at-t', price1:59, price2:59 },
  { id:124, type:'iphone-8-plus', carrier:'sprint', price1:30, price2:28 },
  { id:125, type:'iphone-8-plus', carrier:'sprint', price1:57, price2:57 },
  { id:126, type:'iphone-8-plus', carrier:'sprint', price1:59, price2:59 },
  { id:127, type:'iphone-8-plus', carrier:'t-mobile', price1:28, price2:28 },
  { id:128, type:'iphone-8-plus', carrier:'t-mobile', price1:28, price2:28 },
  { id:129, type:'iphone-8-plus', carrier:'t-mobile', price1:59, price2:59 },
  { id:130, type:'iphone-8-plus', carrier:'verizon', price1:58, price2:58 },
  { id:131, type:'iphone-8-plus', carrier:'verizon', price1:58, price2:58 },
  { id:132, type:'iphone-8-plus', carrier:'verizon', price1:62, price2:62 },
  { id:133, type:'iphone-8-plus', carrier:'unlocked', price1:61, price2:61 },
  { id:134, type:'iphone-8-plus', carrier:'unlocked', price1:63, price2:61 },
  { id:135, type:'iphone-8-plus', carrier:'unlocked', price1:76, price2:76 },
  { id:136, type:'iphone-8-plus', carrier:'other', price1:42, price2:28 },
  { id:137, type:'iphone-8-plus', carrier:'other', price1:57, price2:57 },
  { id:138, type:'iphone-8-plus', carrier:'other', price1:58, price2:58 },
  { id:139, type:'iphone-8', carrier:'at-t', price1:20, price2:15 },
  { id:140, type:'iphone-8', carrier:'at-t', price1:17, price2:17 },
  { id:141, type:'iphone-8', carrier:'at-t', price1:20, price2:19 },
  { id:142, type:'iphone-8', carrier:'sprint', price1:17, price2:15 },
  { id:143, type:'iphone-8', carrier:'sprint', price1:17, price2:16 },
  { id:144, type:'iphone-8', carrier:'sprint', price1:20, price2:18 },
  { id:145, type:'iphone-8', carrier:'t-mobile', price1:15, price2:15 },
  { id:146, type:'iphone-8', carrier:'t-mobile', price1:15, price2:15 },
  { id:147, type:'iphone-8', carrier:'t-mobile', price1:16, price2:16 },
  { id:148, type:'iphone-8', carrier:'verizon', price1:30, price2:19 },
  { id:149, type:'iphone-8', carrier:'verizon', price1:24, price2:19 },
  { id:150, type:'iphone-8', carrier:'verizon', price1:45, price2:45 },
  { id:151, type:'iphone-8', carrier:'unlocked', price1:48, price2:48 },
  { id:152, type:'iphone-8', carrier:'unlocked', price1:48, price2:48 },
  { id:153, type:'iphone-8', carrier:'unlocked', price1:51, price2:51 },
  { id:154, type:'iphone-8', carrier:'other', price1:27, price2:18 },
  { id:155, type:'iphone-8', carrier:'other', price1:27, price2:18 },
  { id:156, type:'iphone-8', carrier:'other', price1:27, price2:19 },
  { id:157, type:'iphone-7-plus', carrier:'at-t', price1:28, price2:14 },
  { id:158, type:'iphone-7-plus', carrier:'at-t', price1:26, price2:15 },
  { id:159, type:'iphone-7-plus', carrier:'at-t', price1:32, price2:16 },
  { id:160, type:'iphone-7-plus', carrier:'sprint', price1:24, price2:13 },
  { id:161, type:'iphone-7-plus', carrier:'sprint', price1:19, price2:14 },
  { id:162, type:'iphone-7-plus', carrier:'sprint', price1:17, price2:14 },
  { id:163, type:'iphone-7-plus', carrier:'t-mobile', price1:17, price2:13 },
  { id:164, type:'iphone-7-plus', carrier:'t-mobile', price1:16, price2:14 },
  { id:165, type:'iphone-7-plus', carrier:'t-mobile', price1:19, price2:15 },
  { id:166, type:'iphone-7-plus', carrier:'verizon', price1:27, price2:16 },
  { id:167, type:'iphone-7-plus', carrier:'verizon', price1:26, price2:16 },
  { id:168, type:'iphone-7-plus', carrier:'verizon', price1:18, price2:16 },
  { id:169, type:'iphone-7-plus', carrier:'metropcs', price1:27, price2:16 },
  { id:170, type:'iphone-7-plus', carrier:'metropcs', price1:27, price2:16 },
  { id:171, type:'iphone-7-plus', carrier:'unlocked', price1:40, price2:20 },
  { id:172, type:'iphone-7-plus', carrier:'unlocked', price1:52, price2:52 },
  { id:173, type:'iphone-7-plus', carrier:'unlocked', price1:54, price2:54 },
  { id:174, type:'iphone-7-plus', carrier:'other', price1:27, price2:16 },
  { id:175, type:'iphone-7-plus', carrier:'other', price1:27, price2:16 },
  { id:177, type:'iphone-7', carrier:'at-t', price1:11, price2:1 },
  { id:178, type:'iphone-7', carrier:'at-t', price1:9, price2:1 },
  { id:184, type:'iphone-7', carrier:'t-mobile', price1:2, price2:2 },
  { id:185, type:'iphone-7', carrier:'verizon', price1:13, price2:2 },
  { id:186, type:'iphone-7', carrier:'verizon', price1:7, price2:2 },
  { id:187, type:'iphone-7', carrier:'verizon', price1:19, price2:4 },
  { id:188, type:'iphone-7', carrier:'unlocked', price1:12, price2:3 },
  { id:189, type:'iphone-7', carrier:'unlocked', price1:14, price2:8 },
  { id:190, type:'iphone-7', carrier:'unlocked', price1:13, price2:8 },
  { id:194, type:'iphone-6s-plus', carrier:'at-t', price1:15, price2:15 },
  { id:203, type:'iphone-6s-plus', carrier:'verizon', price1:7, price2:3 },
  { id:204, type:'iphone-6s-plus', carrier:'verizon', price1:18, price2:3 },
  { id:205, type:'iphone-6s-plus', carrier:'verizon', price1:20, price2:6 },
  { id:206, type:'iphone-6s-plus', carrier:'verizon', price1:23, price2:8 },
  { id:207, type:'iphone-6s-plus', carrier:'unlocked', price1:12, price2:3 },
  { id:208, type:'iphone-6s-plus', carrier:'unlocked', price1:18, price2:3 },
  { id:209, type:'iphone-6s-plus', carrier:'unlocked', price1:21, price2:6 },
  { id:210, type:'iphone-6s-plus', carrier:'unlocked', price1:23, price2:8 },
  { id:225, type:'iphone-6s', carrier:'verizon', price1:1, price2:1 },
  { id:226, type:'iphone-6s', carrier:'verizon', price1:11, price2:1 },
  { id:229, type:'iphone-6s', carrier:'unlocked', price1:1, price2:1 },
  { id:230, type:'iphone-6s', carrier:'unlocked', price1:11, price2:1 },
  { id:235, type:'iphone-6-plus', carrier:'verizon', price1:5, price2:5 },
  { id:236, type:'iphone-6-plus', carrier:'verizon', price1:5, price2:5 },
  { id:237, type:'iphone-6-plus', carrier:'verizon', price1:8, price2:8 },
  { id:238, type:'iphone-6-plus', carrier:'verizon', price1:8, price2:8 },
  { id:240, type:'iphone-6-plus', carrier:'unlocked', price1:8, price2:8 },
  { id:241, type:'iphone-6-plus', carrier:'unlocked', price1:8, price2:8 },
  { id:243, type:'iphone-6', carrier:'verizon', price1:1, price2:1 },
  { id:245, type:'iphone-6', carrier:'unlocked', price1:1, price2:1 },
  { id:246, type:'iphone-6', carrier:'unlocked', price1:3, price2:3 },
  { id:247, type:'iphone-se-2nd-gen', carrier:'at-t', price1:14, price2:14 },
  { id:248, type:'iphone-se-2nd-gen', carrier:'at-t', price1:17, price2:17 },
  { id:249, type:'iphone-se-2nd-gen', carrier:'at-t', price1:23, price2:23 },
  { id:250, type:'iphone-se-2nd-gen', carrier:'sprint', price1:14, price2:14 },
  { id:251, type:'iphone-se-2nd-gen', carrier:'sprint', price1:17, price2:17 },
  { id:252, type:'iphone-se-2nd-gen', carrier:'sprint', price1:23, price2:23 },
  { id:253, type:'iphone-se-2nd-gen', carrier:'t-mobile', price1:14, price2:14 },
  { id:254, type:'iphone-se-2nd-gen', carrier:'t-mobile', price1:17, price2:17 },
  { id:255, type:'iphone-se-2nd-gen', carrier:'t-mobile', price1:23, price2:23 },
  { id:256, type:'iphone-se-2nd-gen', carrier:'verizon', price1:14, price2:14 },
  { id:257, type:'iphone-se-2nd-gen', carrier:'verizon', price1:17, price2:17 },
  { id:258, type:'iphone-se-2nd-gen', carrier:'verizon', price1:23, price2:23 },
  { id:259, type:'iphone-se-2nd-gen', carrier:'unlocked', price1:14, price2:14 },
  { id:260, type:'iphone-se-2nd-gen', carrier:'unlocked', price1:20, price2:20 },
  { id:261, type:'iphone-se-2nd-gen', carrier:'unlocked', price1:23, price2:23 },
  { id:262, type:'iphone-se-2nd-gen', carrier:'other', price1:41, price2:16 },
  { id:263, type:'iphone-se-2nd-gen', carrier:'other', price1:48, price2:41 },
  { id:264, type:'iphone-se-2nd-gen', carrier:'other', price1:60, price2:49 },
];

export default (cb) => {
  useEffect(() => {
    const dataType = {
      id: 'number',
      price1: 'number',
      price2: 'number',
    }

    create(Object.keys(DATA[0]))
    .then(() => write(DATA))
    .then(() => cb({
      ...preProcess(DATA),
      dataType,
      x: 'price1',
      y: 'price2',
      selectedGroup: new Set(['carrier'])
    }));
  }, []);
};
